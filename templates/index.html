{% extends "base.html" %}

{% block content %}
<div class="upload-section">
    <h2>Upload Your Content</h2>
    <p>Transform audio recordings, books, and videos into AI-powered notes and summaries</p>

    <form id="uploadForm" method="POST" action="/upload" enctype="multipart/form-data">
        <!-- Four Column Layout -->
        <div class="input-grid" style="grid-template-columns: 1fr auto 1fr auto 1fr auto 1fr;">
            <!-- Voice Recording Section -->
            <div class="upload-column">
                <h3>ğŸ™ï¸ Record Audio</h3>
                <div class="recording-section recording-section-compact">
                    <div class="drop-zone-icon recording-icon">ğŸ”´</div>
                    <p class="recording-hint">Click to start recording</p>

                    <div class="recording-controls">
                        <button type="button" class="btn-record btn-record-compact" id="recordBtn">
                            <span class="record-icon">ğŸ™ï¸</span>
                            <span class="record-text">Record</span>
                        </button>

                        <button type="button" class="btn-stop btn-stop-compact" id="stopBtn" style="display: none;">
                            <span>â¹ï¸</span>
                            <span>Stop</span>
                        </button>
                    </div>

                    <div class="recording-timer" id="recordingTimer" style="display: none;">
                        <span class="recording-pulse"></span>
                        <span id="timerDisplay">00:00</span>
                    </div>

                    <div class="audio-preview" id="audioPreview" style="display: none;">
                        <p>Preview:</p>
                        <audio id="audioPlayback" controls></audio>
                        <button type="button" class="btn btn-secondary btn-small" id="discardBtn">
                            <span>ğŸ—‘ï¸</span>
                            <span>Discard</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Divider -->
            <div class="divider-vertical">
                <span>OR</span>
            </div>

            <!-- Audio Upload Section -->
            <div class="upload-column">
                <h3>ğŸ“ Upload Audio</h3>
                <div class="drop-zone" id="dropZone">
                    <div class="drop-zone-icon">ğŸµ</div>
                    <div class="drop-zone-text">Audio file</div>
                    <div class="drop-zone-hint">MP3, WAV, M4A</div>
                    <input type="file" id="audioFile" name="audio" accept="audio/*,.opus" class="file-input">
                </div>
            </div>

            <!-- Divider -->
            <div class="divider-vertical">
                <span>OR</span>
            </div>

            <!-- Video Section -->
            <div class="upload-column">
                <h3>ğŸ¬ Video</h3>
                <div class="drop-zone video-zone" id="videoZone">
                    <div class="drop-zone-icon">ğŸ“º</div>
                    <div class="drop-zone-text">Add video</div>
                    <div class="drop-zone-hint">File or YouTube URL</div>
                    <input type="file" id="videoFile" name="video" accept="video/*,.mp4,.mov,.avi,.mkv,.webm,.flv,.m4v" class="file-input" style="display: none;">
                    <input type="text" id="videoUrl" name="video_url" placeholder="https://youtube.com/watch?v=..." class="video-url-input" style="display: none;">
                </div>
            </div>

            <!-- Divider -->
            <div class="divider-vertical">
                <span>OR</span>
            </div>

            <!-- Book Upload Section -->
            <div class="upload-column">
                <h3>ğŸ“š Upload Book</h3>
                <div class="drop-zone" id="dropZoneBook">
                    <div class="drop-zone-icon">ğŸ“–</div>
                    <div class="drop-zone-text">Book file</div>
                    <div class="drop-zone-hint">PDF, EPUB, TXT, DOCX</div>
                    <input type="file" id="bookFile" name="book" accept=".pdf,.epub,.txt,.docx,.doc" class="file-input">
                </div>
            </div>
        </div>

        <div id="fileSelected" class="file-selected">
            <span id="fileName"></span>
        </div>

        <button type="submit" class="btn" id="submitBtn">
            <span>&#x1F680;</span>
            <span id="submitBtnText">Process</span>
        </button>
    </form>
</div>

<!-- Result Modal -->
<div id="resultModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>
                <span>&#x2705;</span>
                <span>Your Meeting Notes</span>
            </h2>
            <button class="modal-close" id="closeModal">
                <span>&times;</span>
            </button>
        </div>

        <div class="modal-body">
            <div class="transcript">
                <h3>&#x1F4DD; Transcript</h3>
                <p id="modalTranscript"></p>
            </div>

            <div class="notes">
                <div class="summary-header">
                    <h3>&#x2728; AI-Generated Summary</h3>
                    <div class="translate-controls">
                        <select id="modalTargetLanguage" class="language-select-inline" onchange="translateModalSummary()">
                            <option value="">ğŸŒ Translate</option>
                            <option value="Spanish">ğŸ‡ªğŸ‡¸ Spanish</option>
                            <option value="French">ğŸ‡«ğŸ‡· French</option>
                            <option value="German">ğŸ‡©ğŸ‡ª German</option>
                            <option value="Arabic">ğŸ‡¸ğŸ‡¦ Arabic</option>
                            <option value="Chinese">ğŸ‡¨ğŸ‡³ Chinese</option>
                            <option value="Japanese">ğŸ‡¯ğŸ‡µ Japanese</option>
                            <option value="Korean">ğŸ‡°ğŸ‡· Korean</option>
                            <option value="Portuguese">ğŸ‡µğŸ‡¹ Portuguese</option>
                            <option value="Russian">ğŸ‡·ğŸ‡º Russian</option>
                            <option value="Italian">ğŸ‡®ğŸ‡¹ Italian</option>
                            <option value="Hindi">ğŸ‡®ğŸ‡³ Hindi</option>
                            <option value="Turkish">ğŸ‡¹ğŸ‡· Turkish</option>
                        </select>
                    </div>
                </div>
                <div id="modalSummary"></div>
            </div>

            <!-- Export Options -->
            <div class="export-options">
                <button class="btn btn-export export-btn" onclick="exportModalAsText()">
                    <span>&#x1F4E5;</span>
                    <span>Export as TXT</span>
                </button>
                <button class="btn btn-export export-btn" onclick="exportModalAsMarkdown()">
                    <span>&#x1F4C4;</span>
                    <span>Export as Markdown</span>
                </button>
                <button class="btn btn-secondary export-btn" onclick="copyModalToClipboard()">
                    <span>&#x1F4CB;</span>
                    <span>Copy to Clipboard</span>
                </button>
            </div>

            <!-- Action Buttons -->
            <div class="action-buttons">
                <button class="btn" onclick="closeResultModal()">
                    <span>&#x2B06;</span>
                    <span>Upload Another File</span>
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Video Choice Modal -->
<div id="videoChoiceModal" class="modal video-choice-modal">
    <div class="modal-content video-choice-content">
        <div class="modal-header">
            <h2>
                <span>ğŸ¬</span>
                <span>Choose Video Source</span>
            </h2>
            <button class="modal-close" id="closeVideoChoiceModal">
                <span>&times;</span>
            </button>
        </div>
        <div class="modal-body">
            <div class="video-choice-options">
                <button class="video-choice-btn" id="chooseVideoFile">
                    <span class="choice-icon">ğŸ“</span>
                    <span class="choice-title">Upload File</span>
                    <span class="choice-desc">MP4, MOV, AVI, MKV, WEBM</span>
                </button>
                <button class="video-choice-btn" id="chooseVideoUrl">
                    <span class="choice-icon">ğŸ”—</span>
                    <span class="choice-title">YouTube URL</span>
                    <span class="choice-desc">Paste link to video</span>
                </button>
            </div>
        </div>
    </div>
</div>
{% endblock %}
